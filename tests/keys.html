<!doctype html>
<html>
  <head>
    <script>
    // based on:
    // https://docs.google.com/spreadsheets/d/1R3TQolar_E1J-X2OMaQjYQtjx-F3NGx09y_hkv_tNZI/edit#gid=0

    // maps all codes to a method name
    const keyMap = {
      ctrlKey: {
        shiftKey: {
          F3: 'onPreviousSearchResult',
          KeyR: 'onUpdateAll'
        },
        ArrowUp: 'onMoveUp',
        ArrowDown: 'onMoveDown',
        KeyA: 'onSelectAll',
        KeyC: 'onCopy',
        KeyE: 'onExport',
        KeyF: 'onSearchBar',
        KeyI: 'onImport',
        KeyP: 'onPanel',  // should toggle filters pane
        KeyR: 'onUpdate',
        KeyS: 'onSave',
        KeyV: 'onPaste',
        KeyX: 'onCut'
      },
      Delete: 'onDelete',
      F2: 'onEdit',
      F3: 'onNextSearchResult',
      Insert: 'onInsert'
    };

    const copy = Object.assign({}, keyMap);

    // copy names with same behavior
    keyMap.ctrlKey.KeyG = keyMap.F3;
    keyMap.ctrlKey.shiftKey.KeyG = keyMap.ctrlKey.shiftKey.F3;

    // fix macOS vs others inconsistencies
    keyMap.metaKey = keyMap.ctrlKey;
    keyMap.Backspace = keyMap.Delete;
    keyMap.NumpadEnter = keyMap.Insert;

    // handle all keyboard events per target/element
    class IOKeyboardShortcut {
      constructor(details) {
        this._details = details;
        this._details.target.addEventListener('keydown', this);
      }
      cancel() {
        this._details.target.removeEventListener('keydown', this);
      }
      handleEvent(event) {
        this[`on${event.type}`](event);
      }
      onkeydown(event) {
        const map = event.shiftKey ?
          keyMap.ctrlKey.shiftKey :
          ((event.ctrlKey || event.metaKey) ?
            keyMap.ctrlKey :
            keyMap);
        if (map.hasOwnProperty(event.code)) {
          event.preventDefault();
          const method = map[event.code];
          if (typeof this._details[method] === 'function') {
            this._details[method](event);
          }
          // TODO: remove this
          else {
            document.body.firstChild.textContent = method;
          }
        }
      }
    }

    // example, using the document.body
    this.onload = function () {
      new IOKeyboardShortcut({
        target: document.activeElement
      });
    };
    </script>
  </head>
  <body><div>&nbsp;</div><pre><script>
  document.write(JSON.stringify(copy, null, '  '))
  </script></pre></body>
</html>
